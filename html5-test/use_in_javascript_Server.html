<html>

<head>
	<meta charset="ISO-8859-1">
	
	<script src="swfobject.js" type="text/javascript"></script>
	<script src="PeoteBytesInput.js" type="text/javascript"></script>
	<script src="PeoteBytesOutput.js" type="text/javascript"></script>
	
	<script type="text/javascript">
		function PeoteNetBridge() {
			
			var peoteServer = new PeoteServer({
				onCreateJoint: function(jointNr) {
					console.log("onCreateJoint:"+jointNr);
				},
				onCreateJointError: function(errorNr) {
					console.log("onCreateJointError:"+errorNr);
				},
				onUserConnect: function(jointNr, userNr) {
					console.log("onUserConnect:"+jointNr+", "+userNr);

					var output = new PeoteBytesOutput();
					output.writeByte(255);
					output.writeUInt16(65535);
					output.writeInt16(32767);
					output.writeInt16(-32768);
					output.writeInt32(2147483647);
					output.writeInt32(-2147483648);
					output.writeFloat(1.2345678);
					output.writeDouble(1.2345678901234567890123456789);
					output.writeString("Hello Client " + userNr);
					
					peoteServer.send(userNr, output.getBytes() ); // send chunk
				},
				onUserDisconnect: function(jointNr, userNr, reason) {
					console.log("onUserDisconnect:"+jointNr+", "+userNr+", "+reason);
				},
				onData: function(jointNr, userNr, peoteBytes) {
					console.log("onData: jointNr="+jointNr+", userNr="+userNr);
					
					var input = new PeoteBytesInput(peoteBytes);
					console.log(input.readByte());
					console.log(input.readUInt16());
					console.log(input.readInt16());
					console.log(input.readInt16());
					console.log(input.readInt32());
					console.log(input.readInt32());
					console.log(input.readFloat());
					console.log(input.readDouble());
					console.log(input.readString());
				}
			});
			console.log("create server with id 'testserver':");
			peoteServer.createJoint("localhost", 7680, "testserver");

			console.log("starter_end");
		}
	</script>


	<script type="text/javascript">
		var flashvars = {
		};
		var params = {
			menu: "false",
			scale: "noScale",
			//scale: "exactFit",
			//allowFullscreen: "true",
			//allowScriptAccess: "sameDomain",
			allowScriptAccess: "always",
			allowNetworking: "true",
			bgcolor: "#000000"
			//wmode: "direct"
		};
		var attributes = {
			id:"PeoteNetBridge"
		};
		swfobject.embedSWF("../Export/flash/bin/peoteNetBridge.swf", "PeoteNetBridgeWrapper", "100%", "100%", "11.0.0", "expressInstall.swf", flashvars, params, attributes);
		console.log("swf embedded");
	</script>

	<style type="text/css" media="screen">
		html, body, #PeoteNet { height:100%; }
		body { margin:0; padding:0; overflow:hidden; }
		embed.hidden, object.hidden {
			height: 1px;
			width: 1px;
			position: absolute;
			top: -1000px;
			left: -1000px;
		}
	</style>
</head>

<body style="width:100%;height:100%;">

	<div id="PeoteNetBridgeWrapper">
		<p>Alternative content</p>
		<p><a href="http://www.adobe.com/go/getflashplayer">
				<img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
			</a>
		</p>
	</div>

</body>
</html>
